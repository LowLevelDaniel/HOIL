# Contributing to HOIL-COIL

Thank you for your interest in contributing to the HOIL-COIL project! This document provides guidelines and information for contributors.

## Getting Started

### Prerequisites

- C11 compatible compiler (GCC or Clang recommended)
- Meson build system
- Ninja build tool
- Python 3.x (for Meson)
- Git

### Setting Up Development Environment

1. Clone the repository:
   ```bash
   git clone https://github.com/yourusername/hoil-coil.git
   cd hoil-coil
   ```

2. Set up the build:
   ```bash
   meson setup build
   cd build
   ```

3. Build the project:
   ```bash
   meson compile
   ```

4. Run tests:
   ```bash
   meson test
   ```

### Using Docker

Alternatively, you can use the provided Docker environment:

```bash
# Build the Docker image
docker build -t hoil-coil .

# Run the container
docker run -it -v $(pwd):/app hoil-coil

# Inside the container, you can build and run the project
cd /app
./run.sh example
```

## Project Structure

- `include/` - Header files
  - `coil_format.h` - COIL instruction format definitions
  - `coil_vm.h` - COIL Virtual Machine declarations
  - `hoil_format.h` - HOIL language format definitions
- `src/` - Source files
  - `coil_vm.c` - COIL VM implementation
  - `hoil_to_coil.c` - HOIL to COIL converter
- `test/` - Example HOIL programs and test cases
- `docs/` - Documentation (generated by Doxygen)

## Coding Style

This project follows a C style guide based on NASA and Google C standards:

- Use 2-space indentation (no tabs)
- Variable and function names should be in snake_case
- Constant names should be in UPPER_SNAKE_CASE
- Struct and enum names should use snake_case with a _t suffix
- Use Doxygen-style comments for functions and data structures
- Keep lines under 100 characters
- Braces on the same line for control structures
- Include thorough error checking

Example:

```c
/**
 * @brief Calculate the factorial of a number
 * 
 * @param n The input number
 * @return The factorial of n, or -1 on error
 */
int64_t calculate_factorial(int n) {
  if (n < 0) {
    return -1;  // Error case
  }
  
  int64_t result = 1;
  for (int i = 2; i <= n; i++) {
    result *= i;
  }
  
  return result;
}
```

## Development Process

### Adding Features

1. Create a new branch for your feature:
   ```bash
   git checkout -b feature/your-feature-name
   ```

2. Implement your changes, following the coding style

3. Add tests for your feature

4. Update documentation as needed

5. Submit a pull request

### Bug Fixes

1. Create a branch for your fix:
   ```bash
   git checkout -b fix/bug-description
   ```

2. Implement your fix

3. Add tests that demonstrate the bug is fixed

4. Submit a pull request

## Testing

### Running Tests

Run all tests with:
```bash
cd build
meson test
```

Run with Valgrind memory checking:
```bash
meson test --setup=valgrind
```

### Adding Tests

1. Add your HOIL test program to the `test/` directory
2. Update `meson.build` to include your test

## Documentation

### Building Documentation

Generate documentation with:
```bash
cd build
ninja documentation
```

The output will be in `docs/html/index.html`.

### Writing Documentation

- Use Doxygen-style comments for all public functions and data structures
- Include examples in documentation when appropriate
- Keep the README, GRAMMAR_HOIL, and GRAMMAR_COIL documents up to date

## Working with HOIL and COIL

### HOIL Syntax Guidelines

- Each instruction should be on a separate line
- Use comments (starting with `;`) to document code
- Follow the format: `CATEGORY OPERATION [arguments...]`
- Organize code into logical sections with comment headers

### Adding COIL Operations

When adding new COIL operations:

1. Add the operation code in `include/coil_format.h`
2. Implement the operation in `src/coil_vm.c`
3. Add HOIL-to-COIL translation in `src/hoil_to_coil.c`
4. Document the operation in GRAMMAR_COIL.md
5. Add an example in the test directory

## License

This project is released into the public domain under the [Unlicense](https://unlicense.org/).

## Contact

For questions or feedback, please open an issue on the GitHub repository.